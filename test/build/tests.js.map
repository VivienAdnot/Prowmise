{"version":3,"sources":["webpack:///webpack/bootstrap 93d77e9644641d24f65e","webpack:///./test/main.ts","webpack:///./test/src/prowmiseSpec.ts","webpack:///./src/prowmiseTest.ts"],"names":[],"mappings":"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","file":"tests.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 93d77e9644641d24f65e","import { sampleSpec } from './src/sampleSpec'\r\nimport { prowmiseSpec } from './src/prowmiseSpec'\r\n\r\n//sampleSpec();\r\nprowmiseSpec();\n\n\n// WEBPACK FOOTER //\n// ./test/main.ts","import { Prowmise } from '../../src/prowmiseTest'\r\nimport { State } from '../../src/prowmiseTest'\r\n\r\nexport function prowmiseSpec() {\r\n    describe(\"Prowmise\", () => {\r\n        let instance:Prowmise;\r\n\r\n        beforeEach(function() {\r\n            instance = new Prowmise(function(resolve, reject) {\r\n\r\n            });\r\n        })\r\n\r\n        it(\"should accept new\", () => {\r\n            expect(instance).toBeDefined;\r\n        })\r\n\r\n        it(\"should trigger callback onFulfill\", (done:Function) => {\r\n            instance.done({\r\n                onFulfilled: done,\r\n                onRejected: () => {}\r\n            });            \r\n        })\r\n    });\r\n}\n\n\n// WEBPACK FOOTER //\n// ./test/src/prowmiseSpec.ts","//https://www.promisejs.org/implementing/\r\n\r\nexport const enum State { Pending = 0, Fulfilled = 1, Rejected = 2};\r\n\r\ninterface IProwmiseAction {\r\n    (resolve:Function, reject:Function) : any;\r\n}\r\n\r\ninterface IHandlers {\r\n    onFulfilled: Function,\r\n    onRejected: Function\r\n}\r\n\r\nexport class Prowmise {\r\n    private _state: State;\r\n    private _value: any;\r\n    private _handlers: Array<IHandlers>;\r\n\r\n    constructor(action:IProwmiseAction) {\r\n        this._state = State.Pending;\r\n        this._value = null;\r\n        this._handlers = new Array<IHandlers>();\r\n\r\n        this.doResolve(action, this.resolve, this.reject);\r\n    }\r\n\r\n    public done(handlers:IHandlers): void {\r\n        this.handle(handlers);\r\n    }\r\n\r\n    private fulfill(result: any): void {\r\n        this._state = State.Fulfilled;\r\n        this._value = result;\r\n\r\n        this._handlers.forEach(this.handle);\r\n        this._handlers = null;\r\n    }\r\n\r\n    private reject(error: string) : void {\r\n        this._state = State.Rejected;\r\n        this._value = error; // useless ?\r\n\r\n        this._handlers.forEach(this.handle);\r\n        this._handlers = null;\r\n    }\r\n    \r\n    private resolve(result: any) {\r\n        try {\r\n            const then = this.getThen(result);\r\n            \r\n            if(then) {\r\n                this.doResolve(then.bind(result), this.resolve, this.reject);\r\n                return;\r\n            }\r\n\r\n            this.fulfill(result);\r\n        } catch(e) {\r\n            this.reject(e);\r\n        }\r\n    }\r\n\r\n    private getThen(value: any): Function {\r\n        let t = typeof value;\r\n\r\n        if(value && (t === \"object\" || t === \"function\")) {\r\n            var then = value.then;\r\n            if(typeof then === \"function\") {\r\n                return then;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    private doResolve(action:Function, onFulfilled:Function, onRejected:Function) {\r\n        let done: boolean = false;\r\n\r\n        const callbackOnFulfilled = function(value: string) {\r\n            if(done) {\r\n                return;\r\n            }\r\n\r\n            done = true;\r\n            onFulfilled(value);\r\n        };\r\n\r\n        const callbackOnRejected = function(reason: string) {\r\n            if(done) {\r\n                return;\r\n            }\r\n\r\n            done = true;\r\n            onRejected(reason);\r\n        };\r\n\r\n        try {\r\n            action(callbackOnFulfilled, callbackOnRejected);\r\n        } catch(ex) {\r\n            if(done) {\r\n                return;\r\n            }\r\n\r\n            done = true;\r\n            onRejected(ex);\r\n        }\r\n    }\r\n\r\n    private handle(handler: IHandlers) {\r\n        switch(this._state) {\r\n            case State.Pending:\r\n                this._handlers.push(handler);\r\n                break;\r\n\r\n            case State.Fulfilled:\r\n                handler.onFulfilled(this._value);\r\n                break;\r\n\r\n            case State.Rejected:\r\n                handler.onRejected(this._value);\r\n                break;\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/prowmiseTest.ts"],"sourceRoot":""}